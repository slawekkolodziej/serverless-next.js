(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{56:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return s})),n.d(t,"rightToc",(function(){return l})),n.d(t,"default",(function(){return p}));var r=n(2),o=n(6),a=(n(0),n(95)),i={id:"faq",title:"Frequently Asked Questions",sidebar_label:"FAQs"},s={unversionedId:"faq",id:"faq",isDocsHomePage:!1,title:"Frequently Asked Questions",description:"My component doesn't deploy",source:"@site/docs/faq.md",slug:"/faq",permalink:"/docs/faq",editUrl:"https://github.com/serverless-nextjs/serverless-next.js/documentation/docs/docs/faq.md",version:"current",sidebar_label:"FAQs",sidebar:"someSidebar",previous:{title:"Inputs",permalink:"/docs/inputs"},next:{title:"Examples/Samples",permalink:"/docs/examples"}},l=[{value:"My component doesn&#39;t deploy",id:"my-component-doesnt-deploy",children:[]},{value:"Should I use the serverless-plugin or this component?",id:"should-i-use-the-serverless-plugin-or-this-component",children:[]},{value:"How do I interact with other AWS Services within my app?",id:"how-do-i-interact-with-other-aws-services-within-my-app",children:[]},{value:"CI/CD A new CloudFront distribution is created on every CI build. I wasn&#39;t expecting that",id:"cicd-a-new-cloudfront-distribution-is-created-on-every-ci-build-i-wasnt-expecting-that",children:[]},{value:"My lambda is deployed to <code>us-east-1</code>. How can I deploy it to another region?",id:"my-lambda-is-deployed-to-us-east-1-how-can-i-deploy-it-to-another-region",children:[]},{value:"I require passing additional information into my build",id:"i-require-passing-additional-information-into-my-build",children:[]},{value:"I was expecting for automatic subdomain redirection when using the domainType: www/apex input",id:"i-was-expecting-for-automatic-subdomain-redirection-when-using-the-domaintype-wwwapex-input",children:[]}],c={rightToc:l};function p(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(a.b)("wrapper",Object(r.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("h3",{id:"my-component-doesnt-deploy"},"My component doesn't deploy"),Object(a.b)("p",null,"Make sure your ",Object(a.b)("inlineCode",{parentName:"p"},"serverless.yml")," uses the ",Object(a.b)("inlineCode",{parentName:"p"},"serverless-components")," format. ",Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://serverless.com/blog/what-are-serverless-components-how-use/"}),"serverless components")," differ from the original serverless framework, even though they are both accessible via the same CLI."),Object(a.b)("p",null,"\u2705 ",Object(a.b)("strong",{parentName:"p"},"Do")),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-yml"}),"# serverless.yml\nmyNextApp:\n  component: serverless-next.js\n\nmyTable:\n  component: serverless/aws-dynamodb\n  inputs:\n    name: Customers\n# other components\n")),Object(a.b)("p",null,"\u274c ",Object(a.b)("strong",{parentName:"p"},"Don't")),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-yml"}),"# serverless.yml\nprovider:\n  name: aws\n  runtime: nodejs10.x\n  region: eu-west-1\n\nmyNextApp:\n  component: serverless-next.js\n\nResources: ...\n")),Object(a.b)("p",null,"Note how the correct yaml doesn't declare a ",Object(a.b)("inlineCode",{parentName:"p"},"provider"),", ",Object(a.b)("inlineCode",{parentName:"p"},"Resources"),", etc."),Object(a.b)("p",null,"For deploying, don't run ",Object(a.b)("inlineCode",{parentName:"p"},"serverless deploy"),". Simply run ",Object(a.b)("inlineCode",{parentName:"p"},"serverless")," and that deploys your components declared in the ",Object(a.b)("inlineCode",{parentName:"p"},"serverless.yml")," file."),Object(a.b)("p",null,"For more information about serverless components go ",Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://serverless.com/blog/what-are-serverless-components-how-use/"}),"here"),"."),Object(a.b)("h3",{id:"should-i-use-the-serverless-plugin-or-this-component"},"Should I use the ",Object(a.b)("a",Object(r.a)({parentName:"h3"},{href:"https://github.com/serverless-nextjs/serverless-next.js/tree/master/packages/deprecated/serverless-plugin"}),"serverless-plugin")," or this component?"),Object(a.b)("p",null,"Users are encouraged to use this component instead of the ",Object(a.b)("inlineCode",{parentName:"p"},"serverless-plugin"),". This component was built and designed using lessons learned from the serverless plugin."),Object(a.b)("h3",{id:"how-do-i-interact-with-other-aws-services-within-my-app"},"How do I interact with other AWS Services within my app?"),Object(a.b)("p",null,"See ",Object(a.b)("inlineCode",{parentName:"p"},"examples/dynamodb-crud")," for an example Todo application that interacts with DynamoDB. You can find a full list of examples ",Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/serverless-nextjs/serverless-next.js/tree/master/packages/serverless-component/examples"}),"here")),Object(a.b)("h3",{id:"cicd-a-new-cloudfront-distribution-is-created-on-every-ci-build-i-wasnt-expecting-that"},"[CI/CD]"," A new CloudFront distribution is created on every CI build. I wasn't expecting that"),Object(a.b)("p",null,"You need to commit your application state in source control. That is the files under the ",Object(a.b)("inlineCode",{parentName:"p"},".serverless")," directory. Alternatively you could use S3 to store the ",Object(a.b)("inlineCode",{parentName:"p"},".serverless")," files, see an example ",Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://gist.github.com/hadynz/b4e190e0ce10e5811cb462920a9c678f"}),"here")),Object(a.b)("p",null,"The serverless team is currently working on remote state storage so this won't be necessary in the future."),Object(a.b)("h3",{id:"my-lambda-is-deployed-to-us-east-1-how-can-i-deploy-it-to-another-region"},"My lambda is deployed to ",Object(a.b)("inlineCode",{parentName:"h3"},"us-east-1"),". How can I deploy it to another region?"),Object(a.b)("p",null,"Serverless next.js is ",Object(a.b)("em",{parentName:"p"},"regionless"),". By design, ",Object(a.b)("inlineCode",{parentName:"p"},"serverless-next.js")," applications will be deployed across the globe to every CloudFront edge location. The lambda might look like is only deployed to ",Object(a.b)("inlineCode",{parentName:"p"},"us-east-1")," but behind the scenes, it is replicated to every other region."),Object(a.b)("h3",{id:"i-require-passing-additional-information-into-my-build"},"I require passing additional information into my build"),Object(a.b)("p",null,"See the sample below for an advanced ",Object(a.b)("inlineCode",{parentName:"p"},"build")," setup that includes passing additional arguments and environment variables to the build."),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-yml"}),'# serverless.yml\nmyDatabase:\n  component: MY_DATABASE_COMPNENT\nmyNextApp:\n  component: serverless-next.js\n  build:\n    args: ["build", "custom/path/to/pages"]\n    env:\n      DATABASE_URL: ${myDatabase.databaseUrl}\n')),Object(a.b)("h3",{id:"i-was-expecting-for-automatic-subdomain-redirection-when-using-the-domaintype-wwwapex-input"},"I was expecting for automatic subdomain redirection when using the domainType: www/apex input"),Object(a.b)("p",null,"The redirection is not currently implemented, but there is a manual workaround outlined ",Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://simonecarletti.com/blog/2016/08/redirect-domain-https-amazon-cloudfront/#configuring-the-amazon-s3-static-site-with-redirect"}),"here"),'.\nIn summary, you will have to create a new S3 bucket and set it up with static website hosting to redirect requests to your supported subdomain type (ex. "',Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"http://www.example.com%22"}),'www.example.com"'),' or "example.com"). To be able to support HTTPS redirects, you\'ll need to set up a CloudFront distribution with the S3 redirect bucket as the origin. Finally, you\'ll need to create an "A" record in Route 53 with your newly created CloudFront distribution as the alias target.'))}p.isMDXComponent=!0},95:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return m}));var r=n(0),o=n.n(r);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=o.a.createContext({}),p=function(e){var t=o.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},d=function(e){var t=p(e.components);return o.a.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},b=o.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,i=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(n),b=r,m=d["".concat(i,".").concat(b)]||d[b]||u[b]||a;return n?o.a.createElement(m,s(s({ref:t},c),{},{components:n})):o.a.createElement(m,s({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=b;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var c=2;c<a;c++)i[c]=n[c];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"}}]);